var mn=Object.create;var Qe=Object.defineProperty;var jn=Object.getOwnPropertyDescriptor;var Ln=Object.getOwnPropertyNames;var xn=Object.getPrototypeOf,wn=Object.prototype.hasOwnProperty;var Xe=(u,e)=>()=>(e||u((e={exports:{}}).exports,e),e.exports);var vn=(u,e,i,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let l of Ln(e))!wn.call(u,l)&&l!==i&&Qe(u,l,{get:()=>e[l],enumerable:!(a=jn(e,l))||a.enumerable});return u};var Ze=(u,e,i)=>(i=u!=null?mn(xn(u)):{},vn(e||!u||!u.__esModule?Qe(i,"default",{value:u,enumerable:!0}):i,u));var en=Xe(o=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.Type=o.JsonType=o.JavaScriptTypeBuilder=o.JsonTypeBuilder=o.TypeBuilder=o.TypeBuilderError=o.TransformEncodeBuilder=o.TransformDecodeBuilder=o.TemplateLiteralDslParser=o.TemplateLiteralGenerator=o.TemplateLiteralGeneratorError=o.TemplateLiteralFinite=o.TemplateLiteralFiniteError=o.TemplateLiteralParser=o.TemplateLiteralParserError=o.TemplateLiteralResolver=o.TemplateLiteralPattern=o.TemplateLiteralPatternError=o.UnionResolver=o.KeyArrayResolver=o.KeyArrayResolverError=o.KeyResolver=o.ObjectMap=o.Intrinsic=o.IndexedAccessor=o.TypeClone=o.TypeExtends=o.TypeExtendsResult=o.TypeExtendsError=o.ExtendsUndefined=o.TypeGuard=o.TypeGuardUnknownTypeError=o.ValueGuard=o.FormatRegistry=o.TypeBoxError=o.TypeRegistry=o.PatternStringExact=o.PatternNumberExact=o.PatternBooleanExact=o.PatternString=o.PatternNumber=o.PatternBoolean=o.Kind=o.Hint=o.Optional=o.Readonly=o.Transform=void 0;o.Transform=Symbol.for("TypeBox.Transform");o.Readonly=Symbol.for("TypeBox.Readonly");o.Optional=Symbol.for("TypeBox.Optional");o.Hint=Symbol.for("TypeBox.Hint");o.Kind=Symbol.for("TypeBox.Kind");o.PatternBoolean="(true|false)";o.PatternNumber="(0|[1-9][0-9]*)";o.PatternString="(.*)";o.PatternBooleanExact=`^${o.PatternBoolean}$`;o.PatternNumberExact=`^${o.PatternNumber}$`;o.PatternStringExact=`^${o.PatternString}$`;var Ve;(function(u){let e=new Map;function i(){return new Map(e)}u.Entries=i;function a(){return e.clear()}u.Clear=a;function l(I){return e.delete(I)}u.Delete=l;function c(I){return e.has(I)}u.Has=c;function T(I,U){e.set(I,U)}u.Set=T;function f(I){return e.get(I)}u.Get=f})(Ve||(o.TypeRegistry=Ve={}));var M=class extends Error{constructor(e){super(e)}};o.TypeBoxError=M;var Ge;(function(u){let e=new Map;function i(){return new Map(e)}u.Entries=i;function a(){return e.clear()}u.Clear=a;function l(I){return e.delete(I)}u.Delete=l;function c(I){return e.has(I)}u.Has=c;function T(I,U){e.set(I,U)}u.Set=T;function f(I){return e.get(I)}u.Get=f})(Ge||(o.FormatRegistry=Ge={}));var g;(function(u){function e(y){return Array.isArray(y)}u.IsArray=e;function i(y){return typeof y=="bigint"}u.IsBigInt=i;function a(y){return typeof y=="boolean"}u.IsBoolean=a;function l(y){return y instanceof globalThis.Date}u.IsDate=l;function c(y){return y===null}u.IsNull=c;function T(y){return typeof y=="number"}u.IsNumber=T;function f(y){return typeof y=="object"&&y!==null}u.IsObject=f;function I(y){return typeof y=="string"}u.IsString=I;function U(y){return y instanceof globalThis.Uint8Array}u.IsUint8Array=U;function O(y){return y===void 0}u.IsUndefined=O})(g||(o.ValueGuard=g={}));var Je=class extends M{};o.TypeGuardUnknownTypeError=Je;var s;(function(u){function e(r){try{return new RegExp(r),!0}catch{return!1}}function i(r){if(!g.IsString(r))return!1;for(let v=0;v<r.length;v++){let B=r.charCodeAt(v);if(B>=7&&B<=13||B===27||B===127)return!1}return!0}function a(r){return T(r)||$(r)}function l(r){return g.IsUndefined(r)||g.IsBigInt(r)}function c(r){return g.IsUndefined(r)||g.IsNumber(r)}function T(r){return g.IsUndefined(r)||g.IsBoolean(r)}function f(r){return g.IsUndefined(r)||g.IsString(r)}function I(r){return g.IsUndefined(r)||g.IsString(r)&&i(r)&&e(r)}function U(r){return g.IsUndefined(r)||g.IsString(r)&&i(r)}function O(r){return g.IsUndefined(r)||$(r)}function y(r){return m(r,"Any")&&f(r.$id)}u.TAny=y;function R(r){return m(r,"Array")&&r.type==="array"&&f(r.$id)&&$(r.items)&&c(r.minItems)&&c(r.maxItems)&&T(r.uniqueItems)&&O(r.contains)&&c(r.minContains)&&c(r.maxContains)}u.TArray=R;function d(r){return m(r,"AsyncIterator")&&r.type==="AsyncIterator"&&f(r.$id)&&$(r.items)}u.TAsyncIterator=d;function b(r){return m(r,"BigInt")&&r.type==="bigint"&&f(r.$id)&&l(r.exclusiveMaximum)&&l(r.exclusiveMinimum)&&l(r.maximum)&&l(r.minimum)&&l(r.multipleOf)}u.TBigInt=b;function S(r){return m(r,"Boolean")&&r.type==="boolean"&&f(r.$id)}u.TBoolean=S;function N(r){return m(r,"Constructor")&&r.type==="Constructor"&&f(r.$id)&&g.IsArray(r.parameters)&&r.parameters.every(v=>$(v))&&$(r.returns)}u.TConstructor=N;function x(r){return m(r,"Date")&&r.type==="Date"&&f(r.$id)&&c(r.exclusiveMaximumTimestamp)&&c(r.exclusiveMinimumTimestamp)&&c(r.maximumTimestamp)&&c(r.minimumTimestamp)&&c(r.multipleOfTimestamp)}u.TDate=x;function j(r){return m(r,"Function")&&r.type==="Function"&&f(r.$id)&&g.IsArray(r.parameters)&&r.parameters.every(v=>$(v))&&$(r.returns)}u.TFunction=j;function A(r){return m(r,"Integer")&&r.type==="integer"&&f(r.$id)&&c(r.exclusiveMaximum)&&c(r.exclusiveMinimum)&&c(r.maximum)&&c(r.minimum)&&c(r.multipleOf)}u.TInteger=A;function K(r){return m(r,"Intersect")&&!(g.IsString(r.type)&&r.type!=="object")&&g.IsArray(r.allOf)&&r.allOf.every(v=>$(v)&&!se(v))&&f(r.type)&&(T(r.unevaluatedProperties)||O(r.unevaluatedProperties))&&f(r.$id)}u.TIntersect=K;function pe(r){return m(r,"Iterator")&&r.type==="Iterator"&&f(r.$id)&&$(r.items)}u.TIterator=pe;function m(r,v){return ne(r)&&r[o.Kind]===v}u.TKindOf=m;function ne(r){return g.IsObject(r)&&o.Kind in r&&g.IsString(r[o.Kind])}u.TKind=ne;function te(r){return J(r)&&g.IsString(r.const)}u.TLiteralString=te;function de(r){return J(r)&&g.IsNumber(r.const)}u.TLiteralNumber=de;function Ke(r){return J(r)&&g.IsBoolean(r.const)}u.TLiteralBoolean=Ke;function J(r){return m(r,"Literal")&&f(r.$id)&&(g.IsBoolean(r.const)||g.IsNumber(r.const)||g.IsString(r.const))}u.TLiteral=J;function fe(r){return m(r,"Never")&&g.IsObject(r.not)&&Object.getOwnPropertyNames(r.not).length===0}u.TNever=fe;function C(r){return m(r,"Not")&&$(r.not)}u.TNot=C;function re(r){return m(r,"Null")&&r.type==="null"&&f(r.$id)}u.TNull=re;function ie(r){return m(r,"Number")&&r.type==="number"&&f(r.$id)&&c(r.exclusiveMaximum)&&c(r.exclusiveMinimum)&&c(r.maximum)&&c(r.minimum)&&c(r.multipleOf)}u.TNumber=ie;function W(r){return m(r,"Object")&&r.type==="object"&&f(r.$id)&&g.IsObject(r.properties)&&a(r.additionalProperties)&&c(r.minProperties)&&c(r.maxProperties)&&Object.entries(r.properties).every(([v,B])=>i(v)&&$(B))}u.TObject=W;function oe(r){return m(r,"Promise")&&r.type==="Promise"&&f(r.$id)&&$(r.item)}u.TPromise=oe;function ye(r){return m(r,"Record")&&r.type==="object"&&f(r.$id)&&a(r.additionalProperties)&&g.IsObject(r.patternProperties)&&(v=>{let B=Object.getOwnPropertyNames(v.patternProperties);return B.length===1&&e(B[0])&&g.IsObject(v.patternProperties)&&$(v.patternProperties[B[0]])})(r)}u.TRecord=ye;function Ee(r){return g.IsObject(r)&&o.Hint in r&&r[o.Hint]==="Recursive"}u.TRecursive=Ee;function Ie(r){return m(r,"Ref")&&f(r.$id)&&g.IsString(r.$ref)}u.TRef=Ie;function Oe(r){return m(r,"String")&&r.type==="string"&&f(r.$id)&&c(r.minLength)&&c(r.maxLength)&&I(r.pattern)&&U(r.format)}u.TString=Oe;function ge(r){return m(r,"Symbol")&&r.type==="symbol"&&f(r.$id)}u.TSymbol=ge;function q(r){return m(r,"TemplateLiteral")&&r.type==="string"&&g.IsString(r.pattern)&&r.pattern[0]==="^"&&r.pattern[r.pattern.length-1]==="$"}u.TTemplateLiteral=q;function be(r){return m(r,"This")&&f(r.$id)&&g.IsString(r.$ref)}u.TThis=be;function se(r){return g.IsObject(r)&&o.Transform in r}u.TTransform=se;function F(r){return m(r,"Tuple")&&r.type==="array"&&f(r.$id)&&g.IsNumber(r.minItems)&&g.IsNumber(r.maxItems)&&r.minItems===r.maxItems&&(g.IsUndefined(r.items)&&g.IsUndefined(r.additionalItems)&&r.minItems===0||g.IsArray(r.items)&&r.items.every(v=>$(v)))}u.TTuple=F;function Ue(r){return m(r,"Undefined")&&r.type==="undefined"&&f(r.$id)}u.TUndefined=Ue;function Be(r){return H(r)&&r.anyOf.every(v=>te(v)||de(v))}u.TUnionLiteral=Be;function H(r){return m(r,"Union")&&f(r.$id)&&g.IsObject(r)&&g.IsArray(r.anyOf)&&r.anyOf.every(v=>$(v))}u.TUnion=H;function Y(r){return m(r,"Uint8Array")&&r.type==="Uint8Array"&&f(r.$id)&&c(r.minByteLength)&&c(r.maxByteLength)}u.TUint8Array=Y;function E(r){return m(r,"Unknown")&&f(r.$id)}u.TUnknown=E;function Pe(r){return m(r,"Unsafe")}u.TUnsafe=Pe;function ue(r){return m(r,"Void")&&r.type==="void"&&f(r.$id)}u.TVoid=ue;function ke(r){return g.IsObject(r)&&r[o.Readonly]==="Readonly"}u.TReadonly=ke;function De(r){return g.IsObject(r)&&r[o.Optional]==="Optional"}u.TOptional=De;function $(r){return g.IsObject(r)&&(y(r)||R(r)||S(r)||b(r)||d(r)||N(r)||x(r)||j(r)||A(r)||K(r)||pe(r)||J(r)||fe(r)||C(r)||re(r)||ie(r)||W(r)||oe(r)||ye(r)||Ie(r)||Oe(r)||ge(r)||q(r)||be(r)||F(r)||Ue(r)||H(r)||Y(r)||E(r)||Pe(r)||ue(r)||ne(r)&&Ve.Has(r[o.Kind]))}u.TSchema=$})(s||(o.TypeGuard=s={}));var he;(function(u){function e(i){return i[o.Kind]==="Intersect"?i.allOf.every(a=>e(a)):i[o.Kind]==="Union"?i.anyOf.some(a=>e(a)):i[o.Kind]==="Undefined"?!0:i[o.Kind]==="Not"?!e(i.not):!1}u.Check=e})(he||(o.ExtendsUndefined=he={}));var Re=class extends M{};o.TypeExtendsError=Re;var p;(function(u){u[u.Union=0]="Union",u[u.True=1]="True",u[u.False=2]="False"})(p||(o.TypeExtendsResult=p={}));var z;(function(u){function e(n){return n===p.False?n:p.True}function i(n){throw new Re(n)}function a(n){return s.TNever(n)||s.TIntersect(n)||s.TUnion(n)||s.TUnknown(n)||s.TAny(n)}function l(n,t){return s.TNever(t)?m(n,t):s.TIntersect(t)?j(n,t):s.TUnion(t)?Me(n,t):s.TUnknown(t)?Ye(n,t):s.TAny(t)?c(n,t):i("StructuralRight")}function c(n,t){return p.True}function T(n,t){return s.TIntersect(t)?j(n,t):s.TUnion(t)&&t.anyOf.some(L=>s.TAny(L)||s.TUnknown(L))?p.True:s.TUnion(t)?p.Union:s.TUnknown(t)||s.TAny(t)?p.True:p.Union}function f(n,t){return s.TUnknown(n)?p.False:s.TAny(n)?p.Union:s.TNever(n)?p.True:p.False}function I(n,t){return s.TObject(t)&&q(t)?p.True:a(t)?l(n,t):s.TArray(t)?e(w(n.items,t.items)):p.False}function U(n,t){return a(t)?l(n,t):s.TAsyncIterator(t)?e(w(n.items,t.items)):p.False}function O(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TBigInt(t)?p.True:p.False}function y(n,t){return s.TLiteral(n)&&g.IsBoolean(n.const)||s.TBoolean(n)?p.True:p.False}function R(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TBoolean(t)?p.True:p.False}function d(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TConstructor(t)?n.parameters.length>t.parameters.length?p.False:n.parameters.every((L,D)=>e(w(t.parameters[D],L))===p.True)?e(w(n.returns,t.returns)):p.False:p.False}function b(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TDate(t)?p.True:p.False}function S(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TFunction(t)?n.parameters.length>t.parameters.length?p.False:n.parameters.every((L,D)=>e(w(t.parameters[D],L))===p.True)?e(w(n.returns,t.returns)):p.False:p.False}function N(n,t){return s.TLiteral(n)&&g.IsNumber(n.const)||s.TNumber(n)||s.TInteger(n)?p.True:p.False}function x(n,t){return s.TInteger(t)||s.TNumber(t)?p.True:a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):p.False}function j(n,t){return t.allOf.every(L=>w(n,L)===p.True)?p.True:p.False}function A(n,t){return n.allOf.some(L=>w(L,t)===p.True)?p.True:p.False}function K(n,t){return a(t)?l(n,t):s.TIterator(t)?e(w(n.items,t.items)):p.False}function pe(n,t){return s.TLiteral(t)&&t.const===n.const?p.True:a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TString(t)?ue(n,t):s.TNumber(t)?J(n,t):s.TInteger(t)?N(n,t):s.TBoolean(t)?y(n,t):p.False}function m(n,t){return p.False}function ne(n,t){return p.True}function te(n){let[t,L]=[n,0];for(;s.TNot(t);)t=t.not,L+=1;return L%2===0?t:o.Type.Unknown()}function de(n,t){return s.TNot(n)?w(te(n),t):s.TNot(t)?w(n,te(t)):i("Invalid fallthrough for Not")}function Ke(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TNull(t)?p.True:p.False}function J(n,t){return s.TLiteralNumber(n)||s.TNumber(n)||s.TInteger(n)?p.True:p.False}function fe(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TInteger(t)||s.TNumber(t)?p.True:p.False}function C(n,t){return Object.getOwnPropertyNames(n.properties).length===t}function re(n){return q(n)}function ie(n){return C(n,0)||C(n,1)&&"description"in n.properties&&s.TUnion(n.properties.description)&&n.properties.description.anyOf.length===2&&(s.TString(n.properties.description.anyOf[0])&&s.TUndefined(n.properties.description.anyOf[1])||s.TString(n.properties.description.anyOf[1])&&s.TUndefined(n.properties.description.anyOf[0]))}function W(n){return C(n,0)}function oe(n){return C(n,0)}function ye(n){return C(n,0)}function Ee(n){return C(n,0)}function Ie(n){return q(n)}function Oe(n){let t=o.Type.Number();return C(n,0)||C(n,1)&&"length"in n.properties&&e(w(n.properties.length,t))===p.True}function ge(n){return C(n,0)}function q(n){let t=o.Type.Number();return C(n,0)||C(n,1)&&"length"in n.properties&&e(w(n.properties.length,t))===p.True}function be(n){let t=o.Type.Function([o.Type.Any()],o.Type.Any());return C(n,0)||C(n,1)&&"then"in n.properties&&e(w(n.properties.then,t))===p.True}function se(n,t){return w(n,t)===p.False||s.TOptional(n)&&!s.TOptional(t)?p.False:p.True}function F(n,t){return s.TUnknown(n)?p.False:s.TAny(n)?p.Union:s.TNever(n)||s.TLiteralString(n)&&re(t)||s.TLiteralNumber(n)&&W(t)||s.TLiteralBoolean(n)&&oe(t)||s.TSymbol(n)&&ie(t)||s.TBigInt(n)&&ye(t)||s.TString(n)&&re(t)||s.TSymbol(n)&&ie(t)||s.TNumber(n)&&W(t)||s.TInteger(n)&&W(t)||s.TBoolean(n)&&oe(t)||s.TUint8Array(n)&&Ie(t)||s.TDate(n)&&Ee(t)||s.TConstructor(n)&&ge(t)||s.TFunction(n)&&Oe(t)?p.True:s.TRecord(n)&&s.TString(H(n))?t[o.Hint]==="Record"?p.True:p.False:s.TRecord(n)&&s.TNumber(H(n))?C(t,0)?p.True:p.False:p.False}function Ue(n,t){return a(t)?l(n,t):s.TRecord(t)?E(n,t):s.TObject(t)?(()=>{for(let L of Object.getOwnPropertyNames(t.properties)){if(!(L in n.properties)&&!s.TOptional(t.properties[L]))return p.False;if(s.TOptional(t.properties[L]))return p.True;if(se(n.properties[L],t.properties[L])===p.False)return p.False}return p.True})():p.False}function Be(n,t){return a(t)?l(n,t):s.TObject(t)&&be(t)?p.True:s.TPromise(t)?e(w(n.item,t.item)):p.False}function H(n){return o.PatternNumberExact in n.patternProperties?o.Type.Number():o.PatternStringExact in n.patternProperties?o.Type.String():i("Unknown record key pattern")}function Y(n){return o.PatternNumberExact in n.patternProperties?n.patternProperties[o.PatternNumberExact]:o.PatternStringExact in n.patternProperties?n.patternProperties[o.PatternStringExact]:i("Unable to get record value schema")}function E(n,t){let[L,D]=[H(t),Y(t)];return s.TLiteralString(n)&&s.TNumber(L)&&e(w(n,D))===p.True?p.True:s.TUint8Array(n)&&s.TNumber(L)||s.TString(n)&&s.TNumber(L)||s.TArray(n)&&s.TNumber(L)?w(n,D):s.TObject(n)?(()=>{for(let Nn of Object.getOwnPropertyNames(n.properties))if(se(D,n.properties[Nn])===p.False)return p.False;return p.True})():p.False}function Pe(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?w(Y(n),Y(t)):p.False}function ue(n,t){return s.TLiteral(n)&&g.IsString(n.const)||s.TString(n)?p.True:p.False}function ke(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TString(t)?p.True:p.False}function De(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TSymbol(t)?p.True:p.False}function $(n,t){return s.TTemplateLiteral(n)?w(V.Resolve(n),t):s.TTemplateLiteral(t)?w(n,V.Resolve(t)):i("Invalid fallthrough for TemplateLiteral")}function r(n,t){return s.TArray(t)&&n.items!==void 0&&n.items.every(L=>w(L,t.items)===p.True)}function v(n,t){return s.TNever(n)?p.True:s.TUnknown(n)?p.False:s.TAny(n)?p.Union:p.False}function B(n,t){return a(t)?l(n,t):s.TObject(t)&&q(t)||s.TArray(t)&&r(n,t)?p.True:s.TTuple(t)?g.IsUndefined(n.items)&&!g.IsUndefined(t.items)||!g.IsUndefined(n.items)&&g.IsUndefined(t.items)?p.False:g.IsUndefined(n.items)&&!g.IsUndefined(t.items)||n.items.every((L,D)=>w(L,t.items[D])===p.True)?p.True:p.False:p.False}function On(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TUint8Array(t)?p.True:p.False}function gn(n,t){return a(t)?l(n,t):s.TObject(t)?F(n,t):s.TRecord(t)?E(n,t):s.TVoid(t)?Pn(n,t):s.TUndefined(t)?p.True:p.False}function Me(n,t){return t.anyOf.some(L=>w(n,L)===p.True)?p.True:p.False}function bn(n,t){return n.anyOf.every(L=>w(L,t)===p.True)?p.True:p.False}function Ye(n,t){return p.True}function Un(n,t){return s.TNever(t)?m(n,t):s.TIntersect(t)?j(n,t):s.TUnion(t)?Me(n,t):s.TAny(t)?c(n,t):s.TString(t)?ue(n,t):s.TNumber(t)?J(n,t):s.TInteger(t)?N(n,t):s.TBoolean(t)?y(n,t):s.TArray(t)?f(n,t):s.TTuple(t)?v(n,t):s.TObject(t)?F(n,t):s.TUnknown(t)?p.True:p.False}function Pn(n,t){return s.TUndefined(n)||s.TUndefined(n)?p.True:p.False}function Rn(n,t){return s.TIntersect(t)?j(n,t):s.TUnion(t)?Me(n,t):s.TUnknown(t)?Ye(n,t):s.TAny(t)?c(n,t):s.TObject(t)?F(n,t):s.TVoid(t)?p.True:p.False}function w(n,t){return s.TTemplateLiteral(n)||s.TTemplateLiteral(t)?$(n,t):s.TNot(n)||s.TNot(t)?de(n,t):s.TAny(n)?T(n,t):s.TArray(n)?I(n,t):s.TBigInt(n)?O(n,t):s.TBoolean(n)?R(n,t):s.TAsyncIterator(n)?U(n,t):s.TConstructor(n)?d(n,t):s.TDate(n)?b(n,t):s.TFunction(n)?S(n,t):s.TInteger(n)?x(n,t):s.TIntersect(n)?A(n,t):s.TIterator(n)?K(n,t):s.TLiteral(n)?pe(n,t):s.TNever(n)?ne(n,t):s.TNull(n)?Ke(n,t):s.TNumber(n)?fe(n,t):s.TObject(n)?Ue(n,t):s.TRecord(n)?Pe(n,t):s.TString(n)?ke(n,t):s.TSymbol(n)?De(n,t):s.TTuple(n)?B(n,t):s.TPromise(n)?Be(n,t):s.TUint8Array(n)?On(n,t):s.TUndefined(n)?gn(n,t):s.TUnion(n)?bn(n,t):s.TUnknown(n)?Un(n,t):s.TVoid(n)?Rn(n,t):i(`Unknown left type operand '${n[o.Kind]}'`)}function Sn(n,t){return w(n,t)}u.Extends=Sn})(z||(o.TypeExtends=z={}));var P;(function(u){function e(I){return I.map(U=>c(U))}function i(I){return new Date(I.getTime())}function a(I){return new Uint8Array(I)}function l(I){let U=Object.getOwnPropertyNames(I).reduce((y,R)=>({...y,[R]:c(I[R])}),{}),O=Object.getOwnPropertySymbols(I).reduce((y,R)=>({...y,[R]:c(I[R])}),{});return{...U,...O}}function c(I){return g.IsArray(I)?e(I):g.IsDate(I)?i(I):g.IsUint8Array(I)?a(I):g.IsObject(I)?l(I):I}function T(I){return I.map(U=>f(U))}u.Rest=T;function f(I,U={}){return{...c(I),...U}}u.Type=f})(P||(o.TypeClone=P={}));var qe;(function(u){function e(d){return d.map(b=>{let{[o.Optional]:S,...N}=P.Type(b);return N})}function i(d){return d.every(b=>s.TOptional(b))}function a(d){return d.some(b=>s.TOptional(b))}function l(d){return i(d.allOf)?o.Type.Optional(o.Type.Intersect(e(d.allOf))):d}function c(d){return a(d.anyOf)?o.Type.Optional(o.Type.Union(e(d.anyOf))):d}function T(d){return d[o.Kind]==="Intersect"?l(d):d[o.Kind]==="Union"?c(d):d}function f(d,b){let S=d.allOf.reduce((N,x)=>{let j=y(x,b);return j[o.Kind]==="Never"?N:[...N,j]},[]);return T(o.Type.Intersect(S))}function I(d,b){let S=d.anyOf.map(N=>y(N,b));return T(o.Type.Union(S))}function U(d,b){let S=d.properties[b];return g.IsUndefined(S)?o.Type.Never():o.Type.Union([S])}function O(d,b){let S=d.items;if(g.IsUndefined(S))return o.Type.Never();let N=S[b];return g.IsUndefined(N)?o.Type.Never():N}function y(d,b){return d[o.Kind]==="Intersect"?f(d,b):d[o.Kind]==="Union"?I(d,b):d[o.Kind]==="Object"?U(d,b):d[o.Kind]==="Tuple"?O(d,b):o.Type.Never()}function R(d,b,S={}){let N=b.map(x=>y(d,x.toString()));return T(o.Type.Union(N,S))}u.Resolve=R})(qe||(o.IndexedAccessor=qe={}));var Q;(function(u){function e(O){let[y,R]=[O.slice(0,1),O.slice(1)];return`${y.toLowerCase()}${R}`}function i(O){let[y,R]=[O.slice(0,1),O.slice(1)];return`${y.toUpperCase()}${R}`}function a(O){return O.toUpperCase()}function l(O){return O.toLowerCase()}function c(O,y){let R=Z.ParseExact(O.pattern);if(!G.Check(R))return{...O,pattern:T(O.pattern,y)};let S=[...h.Generate(R)].map(j=>o.Type.Literal(j)),N=f(S,y),x=o.Type.Union(N);return o.Type.TemplateLiteral([x])}function T(O,y){return typeof O=="string"?y==="Uncapitalize"?e(O):y==="Capitalize"?i(O):y==="Uppercase"?a(O):y==="Lowercase"?l(O):O:O.toString()}function f(O,y){if(O.length===0)return[];let[R,...d]=O;return[U(R,y),...f(d,y)]}function I(O,y){return s.TTemplateLiteral(O)?c(O,y):s.TUnion(O)?o.Type.Union(f(O.anyOf,y)):s.TLiteral(O)?o.Type.Literal(T(O.const,y)):O}function U(O,y){return I(O,y)}u.Map=U})(Q||(o.Intrinsic=Q={}));var X;(function(u){function e(T,f){return o.Type.Intersect(T.allOf.map(I=>l(I,f)),{...T})}function i(T,f){return o.Type.Union(T.anyOf.map(I=>l(I,f)),{...T})}function a(T,f){return f(T)}function l(T,f){return T[o.Kind]==="Intersect"?e(T,f):T[o.Kind]==="Union"?i(T,f):T[o.Kind]==="Object"?a(T,f):T}function c(T,f,I){return{...l(P.Type(T),f),...I}}u.Map=c})(X||(o.ObjectMap=X={}));var Se;(function(u){function e(U){return U[0]==="^"&&U[U.length-1]==="$"?U.slice(1,U.length-1):U}function i(U,O){return U.allOf.reduce((y,R)=>[...y,...T(R,O)],[])}function a(U,O){let y=U.anyOf.map(R=>T(R,O));return[...y.reduce((R,d)=>d.map(b=>y.every(S=>S.includes(b))?R.add(b):R)[0],new Set)]}function l(U,O){return Object.getOwnPropertyNames(U.properties)}function c(U,O){return O.includePatterns?Object.getOwnPropertyNames(U.patternProperties):[]}function T(U,O){return s.TIntersect(U)?i(U,O):s.TUnion(U)?a(U,O):s.TObject(U)?l(U,O):s.TRecord(U)?c(U,O):[]}function f(U,O){return[...new Set(T(U,O))]}u.ResolveKeys=f;function I(U){return`^(${f(U,{includePatterns:!0}).map(R=>`(${e(R)})`).join("|")})$`}u.ResolvePattern=I})(Se||(o.KeyResolver=Se={}));var Ne=class extends M{};o.KeyArrayResolverError=Ne;var ae;(function(u){function e(i){return Array.isArray(i)?i:s.TUnionLiteral(i)?i.anyOf.map(a=>a.const.toString()):s.TLiteral(i)?[i.const]:s.TTemplateLiteral(i)?(()=>{let a=Z.ParseExact(i.pattern);if(!G.Check(a))throw new Ne("Cannot resolve keys from infinite template expression");return[...h.Generate(a)]})():[]}u.Resolve=e})(ae||(o.KeyArrayResolver=ae={}));var He;(function(u){function*e(a){for(let l of a.anyOf)l[o.Kind]==="Union"?yield*e(l):yield l}function i(a){return o.Type.Union([...e(a)],{...a})}u.Resolve=i})(He||(o.UnionResolver=He={}));var me=class extends M{};o.TemplateLiteralPatternError=me;var je;(function(u){function e(c){throw new me(c)}function i(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(c,T){return s.TTemplateLiteral(c)?c.pattern.slice(1,c.pattern.length-1):s.TUnion(c)?`(${c.anyOf.map(f=>a(f,T)).join("|")})`:s.TNumber(c)?`${T}${o.PatternNumber}`:s.TInteger(c)?`${T}${o.PatternNumber}`:s.TBigInt(c)?`${T}${o.PatternNumber}`:s.TString(c)?`${T}${o.PatternString}`:s.TLiteral(c)?`${T}${i(c.const.toString())}`:s.TBoolean(c)?`${T}${o.PatternBoolean}`:e(`Unexpected Kind '${c[o.Kind]}'`)}function l(c){return`^${c.map(T=>a(T,"")).join("")}$`}u.Create=l})(je||(o.TemplateLiteralPattern=je={}));var V;(function(u){function e(i){let a=Z.ParseExact(i.pattern);if(!G.Check(a))return o.Type.String();let l=[...h.Generate(a)].map(c=>o.Type.Literal(c));return o.Type.Union(l)}u.Resolve=e})(V||(o.TemplateLiteralResolver=V={}));var ce=class extends M{};o.TemplateLiteralParserError=ce;var Z;(function(u){function e(d,b,S){return d[b]===S&&d.charCodeAt(b-1)!==92}function i(d,b){return e(d,b,"(")}function a(d,b){return e(d,b,")")}function l(d,b){return e(d,b,"|")}function c(d){if(!(i(d,0)&&a(d,d.length-1)))return!1;let b=0;for(let S=0;S<d.length;S++)if(i(d,S)&&(b+=1),a(d,S)&&(b-=1),b===0&&S!==d.length-1)return!1;return!0}function T(d){return d.slice(1,d.length-1)}function f(d){let b=0;for(let S=0;S<d.length;S++)if(i(d,S)&&(b+=1),a(d,S)&&(b-=1),l(d,S)&&b===0)return!0;return!1}function I(d){for(let b=0;b<d.length;b++)if(i(d,b))return!0;return!1}function U(d){let[b,S]=[0,0],N=[];for(let j=0;j<d.length;j++)if(i(d,j)&&(b+=1),a(d,j)&&(b-=1),l(d,j)&&b===0){let A=d.slice(S,j);A.length>0&&N.push(y(A)),S=j+1}let x=d.slice(S);return x.length>0&&N.push(y(x)),N.length===0?{type:"const",const:""}:N.length===1?N[0]:{type:"or",expr:N}}function O(d){function b(x,j){if(!i(x,j))throw new ce("TemplateLiteralParser: Index must point to open parens");let A=0;for(let K=j;K<x.length;K++)if(i(x,K)&&(A+=1),a(x,K)&&(A-=1),A===0)return[j,K];throw new ce("TemplateLiteralParser: Unclosed group parens in expression")}function S(x,j){for(let A=j;A<x.length;A++)if(i(x,A))return[j,A];return[j,x.length]}let N=[];for(let x=0;x<d.length;x++)if(i(d,x)){let[j,A]=b(d,x),K=d.slice(j,A+1);N.push(y(K)),x=A}else{let[j,A]=S(d,x),K=d.slice(j,A);K.length>0&&N.push(y(K)),x=A-1}return N.length===0?{type:"const",const:""}:N.length===1?N[0]:{type:"and",expr:N}}function y(d){return c(d)?y(T(d)):f(d)?U(d):I(d)?O(d):{type:"const",const:d}}u.Parse=y;function R(d){return y(d.slice(1,d.length-1))}u.ParseExact=R})(Z||(o.TemplateLiteralParser=Z={}));var Le=class extends M{};o.TemplateLiteralFiniteError=Le;var G;(function(u){function e(T){throw new Le(T)}function i(T){return T.type==="or"&&T.expr.length===2&&T.expr[0].type==="const"&&T.expr[0].const==="0"&&T.expr[1].type==="const"&&T.expr[1].const==="[1-9][0-9]*"}function a(T){return T.type==="or"&&T.expr.length===2&&T.expr[0].type==="const"&&T.expr[0].const==="true"&&T.expr[1].type==="const"&&T.expr[1].const==="false"}function l(T){return T.type==="const"&&T.const===".*"}function c(T){return a(T)?!0:i(T)||l(T)?!1:T.type==="and"?T.expr.every(f=>c(f)):T.type==="or"?T.expr.every(f=>c(f)):T.type==="const"?!0:e("Unknown expression type")}u.Check=c})(G||(o.TemplateLiteralFinite=G={}));var xe=class extends M{};o.TemplateLiteralGeneratorError=xe;var h;(function(u){function*e(T){if(T.length===1)return yield*T[0];for(let f of T[0])for(let I of e(T.slice(1)))yield`${f}${I}`}function*i(T){return yield*e(T.expr.map(f=>[...c(f)]))}function*a(T){for(let f of T.expr)yield*c(f)}function*l(T){return yield T.const}function*c(T){return T.type==="and"?yield*i(T):T.type==="or"?yield*a(T):T.type==="const"?yield*l(T):(()=>{throw new xe("Unknown expression")})()}u.Generate=c})(h||(o.TemplateLiteralGenerator=h={}));var ze;(function(u){function*e(c){let T=c.trim().replace(/"|'/g,"");return T==="boolean"?yield o.Type.Boolean():T==="number"?yield o.Type.Number():T==="bigint"?yield o.Type.BigInt():T==="string"?yield o.Type.String():yield(()=>{let f=T.split("|").map(I=>o.Type.Literal(I.trim()));return f.length===0?o.Type.Never():f.length===1?f[0]:o.Type.Union(f)})()}function*i(c){if(c[1]!=="{"){let T=o.Type.Literal("$"),f=a(c.slice(1));return yield*[T,...f]}for(let T=2;T<c.length;T++)if(c[T]==="}"){let f=e(c.slice(2,T)),I=a(c.slice(T+1));return yield*[...f,...I]}yield o.Type.Literal(c)}function*a(c){for(let T=0;T<c.length;T++)if(c[T]==="$"){let f=o.Type.Literal(c.slice(0,T)),I=i(c.slice(T));return yield*[f,...I]}yield o.Type.Literal(c)}function l(c){return[...a(c)]}u.Parse=l})(ze||(o.TemplateLiteralDslParser=ze={}));var we=class{constructor(e){this.schema=e}Decode(e){return new ve(this.schema,e)}};o.TransformDecodeBuilder=we;var ve=class{constructor(e,i){this.schema=e,this.decode=i}Encode(e){let i=P.Type(this.schema);return s.TTransform(i)?(()=>{let c={Encode:T=>i[o.Transform].Encode(e(T)),Decode:T=>this.decode(i[o.Transform].Decode(T))};return{...i,[o.Transform]:c}})():(()=>{let a={Decode:this.decode,Encode:e};return{...i,[o.Transform]:a}})()}};o.TransformEncodeBuilder=ve;var An=0,Ae=class extends M{};o.TypeBuilderError=Ae;var Fe=class{Create(e){return e}Throw(e){throw new Ae(e)}Discard(e,i){return i.reduce((a,l)=>{let{[l]:c,...T}=a;return T},e)}Strict(e){return JSON.parse(JSON.stringify(e))}};o.TypeBuilder=Fe;var Te=class extends Fe{ReadonlyOptional(e){return this.Readonly(this.Optional(e))}Readonly(e){return{...P.Type(e),[o.Readonly]:"Readonly"}}Optional(e){return{...P.Type(e),[o.Optional]:"Optional"}}Any(e={}){return this.Create({...e,[o.Kind]:"Any"})}Array(e,i={}){return this.Create({...i,[o.Kind]:"Array",type:"array",items:P.Type(e)})}Boolean(e={}){return this.Create({...e,[o.Kind]:"Boolean",type:"boolean"})}Capitalize(e,i={}){return{...Q.Map(P.Type(e),"Capitalize"),...i}}Composite(e,i){let a=o.Type.Intersect(e,{}),c=Se.ResolveKeys(a,{includePatterns:!1}).reduce((T,f)=>({...T,[f]:o.Type.Index(a,[f])}),{});return o.Type.Object(c,i)}Enum(e,i={}){if(g.IsUndefined(e))return this.Throw("Enum undefined or empty");let a=Object.getOwnPropertyNames(e).filter(T=>isNaN(T)).map(T=>e[T]),c=[...new Set(a)].map(T=>o.Type.Literal(T));return this.Union(c,{...i,[o.Hint]:"Enum"})}Extends(e,i,a,l,c={}){switch(z.Extends(e,i)){case p.Union:return this.Union([P.Type(a,c),P.Type(l,c)]);case p.True:return P.Type(a,c);case p.False:return P.Type(l,c)}}Exclude(e,i,a={}){return s.TTemplateLiteral(e)?this.Exclude(V.Resolve(e),i,a):s.TTemplateLiteral(i)?this.Exclude(e,V.Resolve(i),a):s.TUnion(e)?(()=>{let l=e.anyOf.filter(c=>z.Extends(c,i)===p.False);return l.length===1?P.Type(l[0],a):this.Union(l,a)})():z.Extends(e,i)!==p.False?this.Never(a):P.Type(e,a)}Extract(e,i,a={}){return s.TTemplateLiteral(e)?this.Extract(V.Resolve(e),i,a):s.TTemplateLiteral(i)?this.Extract(e,V.Resolve(i),a):s.TUnion(e)?(()=>{let l=e.anyOf.filter(c=>z.Extends(c,i)!==p.False);return l.length===1?P.Type(l[0],a):this.Union(l,a)})():z.Extends(e,i)!==p.False?P.Type(e,a):this.Never(a)}Index(e,i,a={}){return s.TArray(e)&&s.TNumber(i)?P.Type(e.items,a):s.TTuple(e)&&s.TNumber(i)?(()=>{let c=(g.IsUndefined(e.items)?[]:e.items).map(T=>P.Type(T));return this.Union(c,a)})():(()=>{let l=ae.Resolve(i),c=P.Type(e);return qe.Resolve(c,l,a)})()}Integer(e={}){return this.Create({...e,[o.Kind]:"Integer",type:"integer"})}Intersect(e,i={}){if(e.length===0)return o.Type.Never();if(e.length===1)return P.Type(e[0],i);e.some(T=>s.TTransform(T))&&this.Throw("Cannot intersect transform types");let a=e.every(T=>s.TObject(T)),l=P.Rest(e),c=s.TSchema(i.unevaluatedProperties)?{unevaluatedProperties:P.Type(i.unevaluatedProperties)}:{};return i.unevaluatedProperties===!1||s.TSchema(i.unevaluatedProperties)||a?this.Create({...i,...c,[o.Kind]:"Intersect",type:"object",allOf:l}):this.Create({...i,...c,[o.Kind]:"Intersect",allOf:l})}KeyOf(e,i={}){return s.TRecord(e)?(()=>{let a=Object.getOwnPropertyNames(e.patternProperties)[0];return a===o.PatternNumberExact?this.Number(i):a===o.PatternStringExact?this.String(i):this.Throw("Unable to resolve key type from Record key pattern")})():s.TTuple(e)?(()=>{let l=(g.IsUndefined(e.items)?[]:e.items).map((c,T)=>o.Type.Literal(T.toString()));return this.Union(l,i)})():s.TArray(e)?this.Number(i):(()=>{let a=Se.ResolveKeys(e,{includePatterns:!1});if(a.length===0)return this.Never(i);let l=a.map(c=>this.Literal(c));return this.Union(l,i)})()}Literal(e,i={}){return this.Create({...i,[o.Kind]:"Literal",const:e,type:typeof e})}Lowercase(e,i={}){return{...Q.Map(P.Type(e),"Lowercase"),...i}}Never(e={}){return this.Create({...e,[o.Kind]:"Never",not:{}})}Not(e,i){return this.Create({...i,[o.Kind]:"Not",not:P.Type(e)})}Null(e={}){return this.Create({...e,[o.Kind]:"Null",type:"null"})}Number(e={}){return this.Create({...e,[o.Kind]:"Number",type:"number"})}Object(e,i={}){let a=Object.getOwnPropertyNames(e),l=a.filter(I=>s.TOptional(e[I])),c=a.filter(I=>!l.includes(I)),T=s.TSchema(i.additionalProperties)?{additionalProperties:P.Type(i.additionalProperties)}:{},f=a.reduce((I,U)=>({...I,[U]:P.Type(e[U])}),{});return c.length>0?this.Create({...i,...T,[o.Kind]:"Object",type:"object",properties:f,required:c}):this.Create({...i,...T,[o.Kind]:"Object",type:"object",properties:f})}Omit(e,i,a={}){let l=ae.Resolve(i);return X.Map(this.Discard(P.Type(e),["$id",o.Transform]),c=>{g.IsArray(c.required)&&(c.required=c.required.filter(T=>!l.includes(T)),c.required.length===0&&delete c.required);for(let T of Object.getOwnPropertyNames(c.properties))l.includes(T)&&delete c.properties[T];return this.Create(c)},a)}Partial(e,i={}){return X.Map(this.Discard(P.Type(e),["$id",o.Transform]),a=>{let l=Object.getOwnPropertyNames(a.properties).reduce((c,T)=>({...c,[T]:this.Optional(a.properties[T])}),{});return this.Object(l,this.Discard(a,["required"]))},i)}Pick(e,i,a={}){let l=ae.Resolve(i);return X.Map(this.Discard(P.Type(e),["$id",o.Transform]),c=>{g.IsArray(c.required)&&(c.required=c.required.filter(T=>l.includes(T)),c.required.length===0&&delete c.required);for(let T of Object.getOwnPropertyNames(c.properties))l.includes(T)||delete c.properties[T];return this.Create(c)},a)}Record(e,i,a={}){return s.TTemplateLiteral(e)?(()=>{let l=Z.ParseExact(e.pattern);return G.Check(l)?this.Object([...h.Generate(l)].reduce((c,T)=>({...c,[T]:P.Type(i)}),{}),a):this.Create({...a,[o.Kind]:"Record",type:"object",patternProperties:{[e.pattern]:P.Type(i)}})})():s.TUnion(e)?(()=>{let l=He.Resolve(e);if(s.TUnionLiteral(l)){let c=l.anyOf.reduce((T,f)=>({...T,[f.const]:P.Type(i)}),{});return this.Object(c,{...a,[o.Hint]:"Record"})}else this.Throw("Record key of type union contains non-literal types")})():s.TLiteral(e)?g.IsString(e.const)||g.IsNumber(e.const)?this.Object({[e.const]:P.Type(i)},a):this.Throw("Record key of type literal is not of type string or number"):s.TInteger(e)||s.TNumber(e)?this.Create({...a,[o.Kind]:"Record",type:"object",patternProperties:{[o.PatternNumberExact]:P.Type(i)}}):s.TString(e)?(()=>{let l=g.IsUndefined(e.pattern)?o.PatternStringExact:e.pattern;return this.Create({...a,[o.Kind]:"Record",type:"object",patternProperties:{[l]:P.Type(i)}})})():this.Never()}Recursive(e,i={}){g.IsUndefined(i.$id)&&(i.$id=`T${An++}`);let a=e({[o.Kind]:"This",$ref:`${i.$id}`});return a.$id=i.$id,this.Create({...i,[o.Hint]:"Recursive",...a})}Ref(e,i={}){return g.IsString(e)?this.Create({...i,[o.Kind]:"Ref",$ref:e}):(g.IsUndefined(e.$id)&&this.Throw("Reference target type must specify an $id"),this.Create({...i,[o.Kind]:"Ref",$ref:e.$id}))}Required(e,i={}){return X.Map(this.Discard(P.Type(e),["$id",o.Transform]),a=>{let l=Object.getOwnPropertyNames(a.properties).reduce((c,T)=>({...c,[T]:this.Discard(a.properties[T],[o.Optional])}),{});return this.Object(l,a)},i)}Rest(e){return s.TTuple(e)&&!g.IsUndefined(e.items)?P.Rest(e.items):s.TIntersect(e)?P.Rest(e.allOf):s.TUnion(e)?P.Rest(e.anyOf):[]}String(e={}){return this.Create({...e,[o.Kind]:"String",type:"string"})}TemplateLiteral(e,i={}){let a=g.IsString(e)?je.Create(ze.Parse(e)):je.Create(e);return this.Create({...i,[o.Kind]:"TemplateLiteral",type:"string",pattern:a})}Transform(e){return new we(e)}Tuple(e,i={}){let[a,l,c]=[!1,e.length,e.length],T=P.Rest(e),f=e.length>0?{...i,[o.Kind]:"Tuple",type:"array",items:T,additionalItems:a,minItems:l,maxItems:c}:{...i,[o.Kind]:"Tuple",type:"array",minItems:l,maxItems:c};return this.Create(f)}Uncapitalize(e,i={}){return{...Q.Map(P.Type(e),"Uncapitalize"),...i}}Union(e,i={}){return s.TTemplateLiteral(e)?V.Resolve(e):(()=>{let a=e;if(a.length===0)return this.Never(i);if(a.length===1)return this.Create(P.Type(a[0],i));let l=P.Rest(a);return this.Create({...i,[o.Kind]:"Union",anyOf:l})})()}Unknown(e={}){return this.Create({...e,[o.Kind]:"Unknown"})}Unsafe(e={}){return this.Create({...e,[o.Kind]:e[o.Kind]||"Unsafe"})}Uppercase(e,i={}){return{...Q.Map(P.Type(e),"Uppercase"),...i}}};o.JsonTypeBuilder=Te;var $e=class extends Te{AsyncIterator(e,i={}){return this.Create({...i,[o.Kind]:"AsyncIterator",type:"AsyncIterator",items:P.Type(e)})}Awaited(e,i={}){let a=l=>l.length>0?(()=>{let[c,...T]=l;return[this.Awaited(c),...a(T)]})():l;return s.TIntersect(e)?o.Type.Intersect(a(e.allOf)):s.TUnion(e)?o.Type.Union(a(e.anyOf)):s.TPromise(e)?this.Awaited(e.item):P.Type(e,i)}BigInt(e={}){return this.Create({...e,[o.Kind]:"BigInt",type:"bigint"})}ConstructorParameters(e,i={}){return this.Tuple([...e.parameters],{...i})}Constructor(e,i,a){let[l,c]=[P.Rest(e),P.Type(i)];return this.Create({...a,[o.Kind]:"Constructor",type:"Constructor",parameters:l,returns:c})}Date(e={}){return this.Create({...e,[o.Kind]:"Date",type:"Date"})}Function(e,i,a){let[l,c]=[P.Rest(e),P.Type(i)];return this.Create({...a,[o.Kind]:"Function",type:"Function",parameters:l,returns:c})}InstanceType(e,i={}){return P.Type(e.returns,i)}Iterator(e,i={}){return this.Create({...i,[o.Kind]:"Iterator",type:"Iterator",items:P.Type(e)})}Parameters(e,i={}){return this.Tuple(e.parameters,{...i})}Promise(e,i={}){return this.Create({...i,[o.Kind]:"Promise",type:"Promise",item:P.Type(e)})}RegExp(e,i={}){let a=g.IsString(e)?e:e.source;return this.Create({...i,[o.Kind]:"String",type:"string",pattern:a})}RegEx(e,i={}){return this.RegExp(e,i)}ReturnType(e,i={}){return P.Type(e.returns,i)}Symbol(e){return this.Create({...e,[o.Kind]:"Symbol",type:"symbol"})}Undefined(e={}){return this.Create({...e,[o.Kind]:"Undefined",type:"undefined"})}Uint8Array(e={}){return this.Create({...e,[o.Kind]:"Uint8Array",type:"Uint8Array"})}Void(e={}){return this.Create({...e,[o.Kind]:"Void",type:"void"})}};o.JavaScriptTypeBuilder=$e;o.JsonType=new Te;o.Type=new $e});var an=Xe((_n,un)=>{un.exports=le;le.flatten=le;le.unflatten=sn;function rn(u){return u&&u.constructor&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function on(u){return u}function le(u,e){e=e||{};let i=e.delimiter||".",a=e.maxDepth,l=e.transformKey||on,c={};function T(f,I,U){U=U||1,Object.keys(f).forEach(function(O){let y=f[O],R=e.safe&&Array.isArray(y),d=Object.prototype.toString.call(y),b=rn(y),S=d==="[object Object]"||d==="[object Array]",N=I?I+i+l(O):l(O);if(!R&&!b&&S&&Object.keys(y).length&&(!e.maxDepth||U<a))return T(y,N,U+1);c[N]=y})}return T(u),c}function sn(u,e){e=e||{};let i=e.delimiter||".",a=e.overwrite||!1,l=e.transformKey||on,c={};if(rn(u)||Object.prototype.toString.call(u)!=="[object Object]")return u;function f(O){let y=Number(O);return isNaN(y)||O.indexOf(".")!==-1||e.object?O:y}function I(O,y,R){return Object.keys(R).reduce(function(d,b){return d[O+i+b]=R[b],d},y)}function U(O){let y=Object.prototype.toString.call(O),R=y==="[object Array]",d=y==="[object Object]";if(O){if(R)return!O.length;if(d)return!Object.keys(O).length}else return!0}return u=Object.keys(u).reduce(function(O,y){let R=Object.prototype.toString.call(u[y]);return!(R==="[object Object]"||R==="[object Array]")||U(u[y])?(O[y]=u[y],O):I(y,O,le(u[y],e))},{}),Object.keys(u).forEach(function(O){let y=O.split(i).map(l),R=f(y.shift()),d=f(y[0]),b=c;for(;d!==void 0;){if(R==="__proto__")return;let S=Object.prototype.toString.call(b[R]),N=S==="[object Object]"||S==="[object Array]";if(!a&&!N&&typeof b[R]<"u")return;(a&&!N||!a&&b[R]==null)&&(b[R]=typeof d=="number"&&!e.object?[]:{}),b=b[R],y.length>0&&(R=f(y.shift()),d=f(y[0]))}b[R]=sn(u[O],e)}),c}});var k=Ze(en(),1),nn=k.Type.String({pattern:"^(\\./|\\../|/)[^*]*\\{languageTag\\}[^*]*\\.json",title:"Path to language files",description:"Specify the pathPattern to locate language files in your repository. It must include `{languageTag}` and end with `.json`.",examples:["./{languageTag}/file.json","../folder/{languageTag}/file.json","./{languageTag}.json"]}),tn=k.Type.Object({pathPattern:k.Type.Union([nn,k.Type.Record(k.Type.String({pattern:"^[^.]+$",description:"Dots are not allowd ",examples:["website","app","homepage"]}),nn)]),variableReferencePattern:k.Type.Optional(k.Type.Array(k.Type.String(),{title:"Variable reference pattern",description:"The pattern to match content in the messages. You can define an opening and closing pattern. The closing pattern is not required. The default is '{{' and '}}'.",examples:["{ and }","{{ and }}","< and >","@:"]})),ignore:k.Type.Optional(k.Type.Array(k.Type.String(),{title:"Ignore paths",description:"Set a path that should be ignored."}))});function ee(u,e,i){return u.replace(new RegExp(Fn(e),"g"),i)}function Fn(u){return u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var Ce=Ze(an(),1);var $n=u=>{let e=cn(u,0);if(e===void 0||!Kn(u[e]))return;let i=cn(u,e+1);if(i!==void 0)return En(u,e,i)},Tn=$n,cn=(u,e)=>{for(let i=e;i<u.length;i+=1){let a=u[i];if(!Cn(a))return i}},Cn=u=>u===" "||u==="	"||u===`
`||u==="\r",Kn=u=>u==="{"||u==="[",En=(u,e,i)=>{let a;for(let l=i-1;l>e;l-=1){let c=u[l];if(c==="\r")return;if(c===`
`)return Bn(a);if(a===void 0)a=c;else if(a[0]===c)a+=c;else return}},Bn=u=>u===void 0?0:u[0]===" "?u.length:u;var _e=u=>{let e=u.endsWith(`
`),i=Tn(u);return(a,l)=>JSON.stringify(a,l,i)+(e?`
`:"")};var yn,We=!1,_="plugin.inlang.json",In={id:_,displayName:"JSON",description:"Plugin for JSON files",settingsSchema:tn,loadMessages:async({settings:u,nodeishFs:e})=>(u[_].variableReferencePattern=u[_].variableReferencePattern||["{","}"],kn({nodeishFs:e,pluginSettings:u[_],languageTags:u.languageTags,sourceLanguageTag:u.sourceLanguageTag})),saveMessages:async({messages:u,settings:e,nodeishFs:i})=>(e[_].variableReferencePattern=e[_].variableReferencePattern||["{","}"],Mn({nodeishFs:i,pluginSettings:e[_],messages:u}))};async function kn(u){let e=[];for(let i of Dn(u.languageTags,u.sourceLanguageTag))if(typeof u.pluginSettings.pathPattern!="string")for(let[a,l]of Object.entries(u.pluginSettings.pathPattern)){let c=await ln(l,i,u.sourceLanguageTag,u.nodeishFs);for(let[T,f]of Object.entries(c))if(Object.keys(f).length!==0){let I=a+":"+ee(T,"u002E",".");pn(e,I,i,f,u.pluginSettings)}}else{let a=await ln(u.pluginSettings.pathPattern,i,u.sourceLanguageTag,u.nodeishFs);for(let[l,c]of Object.entries(a))Object.keys(c).length!==0&&pn(e,ee(l,"u002E","."),i,c,u.pluginSettings)}return e}async function ln(u,e,i,a){let l=u.replace("{languageTag}",e);try{let c=await a.readFile(l,{encoding:"utf-8"});i===e&&(yn=_e(c));let T=JSON.parse(c);return Object.values(T).some(I=>typeof I=="object")&&(We=!0),We?(0,Ce.flatten)(T,{transformKey:function(I){return ee(I,".","u002E")}}):T}catch(c){if(c.code==="FileNotFound"||c.code==="ENOENT")return{};throw c}}var Dn=(u,e)=>{let i=u.filter(a=>a!==e);return i.unshift(e),i},pn=(u,e,i,a,l)=>{let c=u.findIndex(T=>T.id===e);if(c!==-1){let T={languageTag:i,match:[],pattern:dn(a,l.variableReferencePattern)};u[c]?.variants.push(T)}else{let T={id:e,alias:{},selectors:[],variants:[]};T.variants=[{languageTag:i,match:[],pattern:dn(a,l.variableReferencePattern)}],u.push(T)}};function dn(u,e){let i=e[1]?new RegExp(`(\\${e[0]}[^\\${e[1]}]+\\${e[1]})`,"g"):new RegExp(`(${e}\\w+)`,"g");return u.split(i).filter(l=>l!=="").map(l=>i.test(l)&&e[0]?{type:"VariableReference",name:e[1]?l.slice(e[0].length,-e[1].length):l.slice(e[0].length)}:{type:"Text",value:l})}async function Mn(u){if(typeof u.pluginSettings.pathPattern=="object"){let e={};for(let i of u.messages)for(let a of i.variants){let l=i.id.includes(":")?i.id.split(":")[0]:Object.keys(u.pluginSettings.pathPattern)[0],c=i.id.replace(l+":","");e[a.languageTag]??={},e[a.languageTag][l]??={},e[a.languageTag][l][c]=a.pattern}for(let[i,a]of Object.entries(e)){for(let l of Object.values(u.pluginSettings.pathPattern)){let c=l.replace("{languageTag}",i).split("/").slice(0,-1).join("/");try{await u.nodeishFs.readdir(c)}catch{await u.nodeishFs.mkdir(c)}}for(let[l,c]of Object.entries(a)){let T=u.pluginSettings.pathPattern[l].replace("{languageTag}",i);await u.nodeishFs.writeFile(T,fn(c,u.pluginSettings.variableReferencePattern))}}}else{let e={};for(let i of u.messages)for(let a of i.variants)e[a.languageTag]??={},e[a.languageTag][i.id]=a.pattern;for(let[i,a]of Object.entries(e)){let l=u.pluginSettings.pathPattern.replace("{languageTag}",i);try{await u.nodeishFs.readdir(l.split("/").slice(0,-1).join("/"))}catch{await u.nodeishFs.mkdir(l.split("/").slice(0,-1).join("/"),{recursive:!0})}await u.nodeishFs.writeFile(l,fn(a,u.pluginSettings.variableReferencePattern))}}}function fn(u,e){let i={};for(let[a,l]of Object.entries(u)){let c=ee(a,"..","u002E.");c.slice(-1)==="."&&(c=c.replace(/.$/,"u002E")),i[c]=Vn(l,e)}return We&&(i=(0,Ce.unflatten)(i,{object:!0})),ee(yn(i),"u002E",".")}function Vn(u,e){let i=[];for(let a of u)switch(a.type){case"Text":i.push(a.value);break;case"VariableReference":i.push(e[1]?`${e[0]}${a.name}${e[1]}`:`${e[0]}${a.name}`);break;default:throw new Error(`Unknown message pattern element of type: ${a?.type}`)}return i.join("")}var rt=In;export{rt as default};
